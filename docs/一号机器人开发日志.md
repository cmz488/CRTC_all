***  

# **ps2手柄--spi通讯**
## ——— spi控制底盘运动
1. ***10.1号*** 编写ps2手柄电控代码，我们在熟悉了ps2手柄的输出数据（即操作指令）之后，
使用oled面板对ps2和单片机之间的收发功能进行调试，检验了ps2上的两个模式（红灯模式和绿灯模式）的功能正常，
熟悉了ps2的控制方法，为后续控制麦克纳姆轮
能够对接收器发送正确操作信息，同时单片机能够读取接受器发送的信息。
2. ***10.2号*** 在10.2号，我们组装了裸机，在试运行中我们发现，多次重复按按键导致逻辑冲突，
为了避免控制命令杂乱的情况， 采取状态机的思想，将不同运动状态代码封装在函数接口里，
这样极大的简化了输入命令，实现对底盘运动的精准调控。由于我们有两种不同的运动（前后左右运动，和原地转向），
且各种状态互斥，我们建立了两种状态机（控制摇杆和按键），分别为红灯状态和绿灯状态，红灯状态和绿灯状态互斥， 
解决了操控逻辑复杂的问题。
3. ***10.3号*** 我们在调试的时候发现，各种状态的切换极快，经常上一状态没有执行完，就切换到下一状态，
为此我们加入了delay函数，确保状态的连续性，同时对多次命令进行过滤。同时将ps2接发送函数放进while循环，
以保证持续的接收。

***

# **麦轮**  
1. ***10.2号*** 我们对麦轮的转动方向进行了规定，以实现机器人的前后左右运动，并对ps2手柄的操作逻辑进行，和原地转向。如下表

| 麦轮位置 | 向前运动  | 向后  |  向左   |     向右      |  顺时针转向  | 逆时针转向 |
|:----:|:-----:|:---:|:-----:|:-----------:|:-------:|:-----:|
|  左前  | 逆时针转动 | 顺时针 |  顺时针  |     逆时针     |     逆时针    |   顺时针    |
|  右前  | 逆时针转动 |   顺时针  |  逆时针  |     顺时针     |    顺时针      |逆时针  |
|  左后  | 逆时针转动 |   顺时针  |  逆时针  |     顺时针     |    逆时针     |   顺时针    |
|  右后  | 逆时针转动 |   顺时针  |  顺时针  |     逆时针     |     顺时针    |    逆时针   |
> ***注：***
前后左右运动是以右视面为基准，原地转向是以上视面为基准。
***


# **在面包板和PCB板之间进行选择**
## ———进行线路优化
1. ***10.3号*** 我们开启线上讨论，选择是使用面包板和PCB板，得出以下结论：

|  方案  | 面包板            | PCB板                               |
|:----:|:---------------|:-----------------------------------|
|  优点  | 操作简单，制作和学习成本较低 | 线路清晰，不使用杜邦线链接，结构稳定                 |
|  缺点  | 线路复杂，走线杂乱，调试不便 | 制作学习成本高，且在使用多个电机的情况下，<br/>线路并不那么简单 |
综合考虑下，我们选择了面包板，并使用胶带和扎带优化走线。

***

# **第一收集方案**
## ——基于滚刷的方案
1. ***10.4号*** 我们对一号机器人的收集方案进行讨论，从效率和稳定两方面进行考虑，同时纳入简便结构思想。
在观察无人扫地机后，我们制定以滚刷为核心的收集方案，即通过刷子转动，将小球“扫”进位于底盘上方的容器里，刷子是通过电机驱动的，这样不需要操控手操作
（图片）
2. ***10.6号*** 经过对fusion360的学习，我们开始建模，在这个方案中，我们准确测量转动轴到地面的距离，以实现能够将小球滚进容器里，
我们从中学习到准确测量的重要性并把它运用到之后的建模开发中，同时也遇见很多困难，如：如何在容器上开孔，来将容器固定在地盘上，如何设计圆弧型铲子，
能够给滚刷扫进小球时提供支撑？等等很多相关的问题，为此我们制定了草图+拉伸+扫掠的三板斧，迅速解决了建模的燃眉之急。
    > 图片 ![图片](https://github.com/cmz488/CRTC_all/blob/main/%E5%9B%BE%E7%89%87/IMG_20251017_002535.jpg)
    > 
    > 图片 ![](https://github.com/cmz488/CRTC_all/blob/main/%E5%9B%BE%E7%89%87/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-28%20234150.png)

3. ***10.10号*** 在更新的规则中，我们的滚刷与新底板严重不合，且在加上由于刷子过长超过尺寸，但是如果我们为了不超过尺寸来缩短毛刷的长度 ，
这样会使得收集效率大幅度降低，由于前面的挡板过低，容器甚至会有装不了弹丸的风险，我们不得不放弃这个方案从而转到下一个方案。

***

# **第二收集方案**
## ——基于鱼网的收集方案
1. ***10.12号*** 在第一方案破产后，我们继续通过观察现实生活的方法寻找灵感。不由将目光转移到渔网的超强收集功能。我们总结一下几点：
    
    | 方面 | 优点                    |
    |----|-----------------------|
    | 效率 | 依靠惯性收集的方式，让弹丸自己“滚”入网中 |
    | 稳定 | 在网的包裹下，弹丸不易滚出网袋中      |  

2. ***10.13号*** 我们制定了完整的方案：将网安装在底盘下方，这样机器人可以沿着移动轨迹收集弹丸，便利操控；同时利用网的柔软特性，
让机器人能够适应各种地形。然后我们通过建模设计了网的支撑，以方便弹丸滚入，撑开更大的空间，能够容纳更多的小球。
3.  ***10.15号*** 在进行实机组装之后，我们发现机器人上驱动麦轮的马达占据了底盘的空间，这使得小球在底盘前部累积，网的收集功能被大大削减了
我们被迫放弃第二方案，进入迭代。从这中，我们学习到想法总是理想的，任何想法都要切合实际。
    > 图片 ![](https://github.com/cmz488/CRTC_all/blob/main/%E5%9B%BE%E7%89%87/IMG_20251023_144900.jpg)

***

# **TIM计时器**
## ——通过pwm波形控制电机速度和转向
1. ***10.15*** 在裸机测试中，我们发现，机器人原地转向的速度过快，难以精确操控转动的方向。所以我们使用ps2手柄的红灯模式，控制机器人的速度。
具体实现方法是通过ps2发送特定命令，调用TIM_Campare函数对CCR的值进行更改，以达到控制占空比，从而控制电机功率的目的。这一改动给操作提供了
精细化设计，提升了操作的精密程度。

*** 

# **方案三**
## ——第一方案的回归
1. ***10.20号*** 在长达几天的思考中，我们渐渐察觉到底盘对我们思想的钳制，在熟读了规则之后，我们做出了自己设计底盘的决定，我们以官方的底盘文件
为底设计了符合滚刷的底盘。
2.  ***10.22号*** 在用3d打印机打印出模型之后，我们迅速进行装机，测试收集效率，储存稳定性各个指标，发现机器人能够高效收集弹丸，并且能够稳定
储存。自此，我们一号机器人方案正式落实。
    > 图片：![photo](https://github.com/cmz488/CRTC_all/blob/main/%E5%9B%BE%E7%89%87/2B4CD31F92342293063E53C42FDF9BDE.jpg)
    > 
    > 图片：![photo](https://github.com/cmz488/CRTC_all/blob/main/%E5%9B%BE%E7%89%87/%E5%B0%8F%E8%BD%A6%E5%BB%BA%E6%A8%A1%E5%9B%BE2.png)
3. ***10.25号*** 优化了机器人走线，对各个硬件位置进行调整。

